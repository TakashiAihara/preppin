# 要件書

## 概要

備蓄管理用のクロスプラットフォーム（Android x iOS）アプリケーション。ユーザーが家庭や職場での備蓄品を効率的に管理し、適切な在庫レベルを維持できるようにする。

## 要件

### 要件 1

**ユーザーストーリー:** 備蓄管理者として、備蓄品を登録・管理したいので、在庫の全体像を把握できるようになりたい

#### 受入基準

1. WHEN ユーザーが新しい備蓄品を追加する THEN システムは商品名、カテゴリ、数量、賞味期限、保管場所を記録する SHALL
2. WHEN ユーザーが備蓄品リストを表示する THEN システムは登録済みの全ての備蓄品を一覧表示する SHALL
3. WHEN ユーザーが備蓄品の情報を編集する THEN システムは変更内容を保存し、更新日時を記録する SHALL
4. WHEN ユーザーが備蓄品を削除する THEN システムは確認ダイアログを表示し、承認後に削除する SHALL

### 要件 2

**ユーザーストーリー:** 備蓄管理者として、賞味期限と消費期限を区別して管理したいので、食品の安全性と品質を適切に判断できるようになりたい

#### 受入基準

1. WHEN ユーザーが食品を登録する THEN システムは賞味期限と消費期限の両方を入力できるオプションを提供する SHALL
2. WHEN 商品に消費期限が設定されている THEN システムは消費期限を優先して期限管理を行う SHALL
3. WHEN 消費期限まで3日以内の商品がある THEN システムは緊急アラート（赤色）を表示する SHALL
4. WHEN 消費期限まで7日以内の商品がある THEN システムは警告アラート（オレンジ色）を表示する SHALL
5. WHEN 賞味期限まで30日以内の商品がある THEN システムは注意アラート（黄色）を表示する SHALL
6. WHEN 賞味期限まで7日以内の商品がある THEN システムは警告アラート（オレンジ色）を表示する SHALL
7. WHEN ユーザーが期限切れ商品リストを確認する THEN システムは消費期限、賞味期限の順で優先度をつけてソートする SHALL
8. IF 商品に両方の期限が設定されている THEN システムは期限表示で「消費期限：[日付] / 賞味期限：[日付]」の形式で表示する SHALL
9. WHEN 商品を消費した際 THEN システムは在庫数量を自動的に減算する SHALL

### 要件 3

**ユーザーストーリー:** 備蓄管理者として、在庫が少なくなった商品を知りたいので、適切なタイミングで補充できるようになりたい

#### 受入基準

1. WHEN 商品の在庫数が設定した最小在庫数を下回る THEN システムは補充アラートを表示する SHALL
2. WHEN ユーザーが最小在庫数を設定する THEN システムは商品ごとに個別の閾値を保存する SHALL
3. WHEN 補充が必要な商品がある THEN システムはショッピングリストを自動生成する SHALL
4. IF ユーザーが商品を購入して在庫を追加する THEN システムは在庫数を更新し、購入日を記録する SHALL

### 要件 4

**ユーザーストーリー:** 備蓄管理者として、カテゴリ別に備蓄品を整理したいので、効率的に管理できるようになりたい

#### 受入基準

1. WHEN ユーザーがカテゴリを作成する THEN システムは食品、日用品、医薬品、その他のカテゴリを提供する SHALL
2. WHEN ユーザーが商品をカテゴリで絞り込む THEN システムは該当するカテゴリの商品のみを表示する SHALL
3. WHEN ユーザーがカテゴリ別の統計を確認する THEN システムは各カテゴリの商品数と総価値を表示する SHALL
4. IF ユーザーがカスタムカテゴリを作成する THEN システムは新しいカテゴリを保存し、商品に割り当て可能にする SHALL

### 要件 5

**ユーザーストーリー:** モバイルユーザーとして、オフラインでもアプリを使用したいので、インターネット接続がない環境でも備蓄管理ができるようになりたい

#### 受入基準

1. WHEN インターネット接続がない状態でアプリを起動する THEN システムはローカルデータを使用して動作する SHALL
2. WHEN オフライン状態で商品を追加・編集する THEN システムは変更をローカルに保存する SHALL
3. WHEN インターネット接続が復旧する THEN システムはローカルの変更をクラウドと同期する SHALL
4. IF 同期中に競合が発生する THEN システムは最新の変更を優先し、競合を解決する SHALL

### 要件 6

**ユーザーストーリー:** 備蓄管理者として、備蓄品にタグを付けて分類したいので、柔軟な検索と整理ができるようになりたい

#### 受入基準

1. WHEN ユーザーが備蓄品にタグを追加する THEN システムは複数のタグを商品に関連付けて保存する SHALL
2. WHEN ユーザーがタグで商品を検索する THEN システムは該当するタグが付いた商品を一覧表示する SHALL
3. WHEN ユーザーがタグを作成する THEN システムは新しいタグを保存し、他の商品にも適用可能にする SHALL
4. IF ユーザーがタグを削除する THEN システムは確認ダイアログを表示し、関連する商品からもタグを削除する SHALL
5. WHEN ユーザーがタグ一覧を表示する THEN システムは使用頻度順にタグを表示する SHALL

### 要件 7

**ユーザーストーリー:** 備蓄管理者として、備蓄品の消費を記録・管理したいので、消費パターンを把握し将来の在庫切れを予測できるようになりたい

#### 受入基準

1. WHEN ユーザーが商品を消費する THEN システムは消費数量、消費日時、消費理由を記録する SHALL
2. WHEN ユーザーが消費履歴を確認する THEN システムは商品ごとの消費推移をグラフで表示する SHALL
3. WHEN システムが消費パターンを分析する THEN システムは過去の消費データから平均消費量を算出する SHALL
4. WHEN 現在の在庫と消費パターンから予測する THEN システムは在庫切れ予想日を計算して表示する SHALL
5. IF 在庫切れ予想日が30日以内 THEN システムは早期補充アラートを表示する SHALL
6. WHEN ユーザーが消費予測を確認する THEN システムは商品ごとの推定残り日数を一覧表示する SHALL

### 要件 8

**ユーザーストーリー:** 備蓄管理者として、備蓄品の総資産価値を把握したいので、効率的な予算管理ができるようになりたい

#### 受入基準

1. WHEN 商品にASINが関連付けられている THEN システムは最新の価格情報を取得して保存する SHALL
2. WHEN ユーザーが備蓄品の合計金額を確認する THEN システムは全商品の価格×数量の合計を表示する SHALL
3. WHEN ユーザーがカテゴリ別の金額を確認する THEN システムは各カテゴリの合計金額を表示する SHALL
4. IF 価格情報が取得できない商品がある THEN システムは手動価格入力オプションを提供する SHALL
5. WHEN 価格情報が更新される THEN システムは合計金額を自動的に再計算する SHALL

### 要件 9

**ユーザーストーリー:** 管理者として、PC用の管理画面で備蓄品を効率的に管理したいので、大画面での一括編集や詳細分析ができるようになりたい

#### 受入基準

1. WHEN 管理者がPC用管理画面にアクセスする THEN システムはWebブラウザで管理インターフェースを表示する SHALL
2. WHEN 管理画面で備蓄品一覧を表示する THEN システムは検索、フィルタ、ソート機能を提供する SHALL
3. WHEN 管理者が商品情報を編集する THEN システムは一括編集機能とCSVインポート/エクスポート機能を提供する SHALL
4. WHEN 管理画面でダッシュボードを表示する THEN システムは在庫状況、期限切れ商品、消費統計をグラフで表示する SHALL
5. IF モバイルアプリで変更が行われる THEN システムは管理画面の表示をリアルタイムで更新する SHALL
6. WHEN 管理者が設定を変更する THEN システムは通知設定、カテゴリ管理、ユーザー管理機能を提供する SHALL

### 要件 10

**ユーザーストーリー:** モバイルユーザーとして、バーコードスキャンで商品を簡単に登録したいので、手入力の手間を省きたい

#### 受入基準

1. WHEN ユーザーがバーコードスキャン機能を使用する THEN システムはカメラを起動してJANコードを読み取る SHALL
2. WHEN JANコードが正常に読み取られる THEN システムは商品データベースから商品情報を検索して取得する SHALL
3. WHEN 商品情報が見つかる THEN システムは商品名、価格、画像、カテゴリを自動的に入力フォームに反映する SHALL
4. IF JANコードから商品情報が取得できない THEN システムはASIN連携APIを使用して商品情報を検索する SHALL
5. WHEN ASIN連携で商品情報が取得される THEN システムはAmazonの商品データを入力フォームに反映する SHALL
6. IF 両方のデータソースから情報が取得できない THEN システムは手動入力モードに切り替える SHALL
7. WHEN スキャンした商品が既に登録済み THEN システムは数量の追加オプションを提供する SHALL

### 要件 11

**ユーザーストーリー:** 新規ユーザーとして、アカウントを作成してログインしたいので、個人の備蓄データを安全に管理できるようになりたい

#### 受入基準

1. WHEN ユーザーが新規アカウントを作成する THEN システムはメールアドレス、パスワード、表示名の入力を求める SHALL
2. WHEN ユーザーがメールアドレスを入力する THEN システムは有効なメール形式であることを検証する SHALL
3. WHEN ユーザーがパスワードを設定する THEN システムは8文字以上で英数字を含むパスワードを要求する SHALL
4. WHEN アカウント作成が完了する THEN システムは確認メールを送信し、メール認証を要求する SHALL
5. WHEN ユーザーがログインする THEN システムはメールアドレスとパスワードで認証を行う SHALL
6. IF ログイン認証に失敗する THEN システムはエラーメッセージを表示し、パスワードリセット機能を提供する SHALL
7. WHEN ユーザーがパスワードを忘れる THEN システムはメールでパスワードリセットリンクを送信する SHALL

### 要件 12

**ユーザーストーリー:** 家族の代表者として、家族グループを作成したいので、家族全員で備蓄品を共有管理できるようになりたい

#### 受入基準

1. WHEN ユーザーが新しい組織（家族グループ）を作成する THEN システムは組織名、説明、プライバシー設定の入力を求める SHALL
2. WHEN 組織が作成される THEN システムは作成者を管理者として設定し、招待コードを生成する SHALL
3. WHEN 管理者が家族メンバーを招待する THEN システムはメールまたは招待コードで招待を送信する SHALL
4. WHEN 招待されたユーザーが招待を承認する THEN システムはユーザーを組織メンバーとして追加する SHALL
5. WHEN 組織メンバーが備蓄品を追加する THEN システムは全メンバーが閲覧・編集できるように共有する SHALL
6. IF ユーザーが複数の組織に所属する THEN システムは組織切り替え機能を提供する SHALL
7. WHEN 管理者がメンバーの権限を変更する THEN システムは閲覧のみ、編集可能、管理者の権限レベルを設定する SHALL

### 要件 13

**ユーザーストーリー:** 家族メンバーとして、備蓄品の保管場所を記録・共有したいので、家族全員が物の場所を把握できるようになりたい

#### 受入基準

1. WHEN ユーザーが備蓄品を登録する THEN システムは保管場所の入力フィールドを提供する SHALL
2. WHEN ユーザーが保管場所を入力する THEN システムは過去に使用した場所を候補として表示する SHALL
3. WHEN 保管場所が設定される THEN システムは場所ごとの備蓄品一覧を表示する機能を提供する SHALL
4. WHEN ユーザーが場所別表示を選択する THEN システムは冷蔵庫、冷凍庫、パントリー、物置などの場所でグループ化して表示する SHALL
5. IF ユーザーが新しい保管場所を追加する THEN システムは組織内の全メンバーが使用できるように共有する SHALL
6. WHEN 家族メンバーが備蓄品を移動する THEN システムは保管場所の変更履歴を記録する SHALL
7. WHEN ユーザーが特定の場所の備蓄品を検索する THEN システムは場所をフィルター条件として使用できる SHALL

### 要件 14

**ユーザーストーリー:** 組織管理者として、メンバーの活動を監視・管理したいので、適切な備蓄管理が行われていることを確認できるようになりたい

#### 受入基準

1. WHEN 管理者が組織の活動ログを確認する THEN システムはメンバーの追加・編集・削除活動を時系列で表示する SHALL
2. WHEN メンバーが備蓄品を変更する THEN システムは変更者、変更内容、変更日時を記録する SHALL
3. WHEN 管理者がメンバー管理画面を開く THEN システムは各メンバーの権限、最終ログイン日、活動統計を表示する SHALL
4. IF 管理者がメンバーを削除する THEN システムは確認ダイアログを表示し、そのメンバーが追加した備蓄品の扱いを選択させる SHALL
5. WHEN 組織から退会するメンバーがいる THEN システムは退会処理と個人データの削除オプションを提供する SHALL
6. WHEN 管理者が組織設定を変更する THEN システムは組織名、プライバシー設定、招待設定の変更を許可する SHALL

### 要件 15

**ユーザーストーリー:** 家族メンバーとして、他のメンバーの活動を把握したいので、誰がいつ何を追加・消費したかを知ることができるようになりたい

#### 受入基準

1. WHEN ユーザーが活動フィードを確認する THEN システムは組織内の最近の活動を時系列で表示する SHALL
2. WHEN メンバーが備蓄品を追加する THEN システムは「[メンバー名]が[商品名]を追加しました」という通知を生成する SHALL
3. WHEN メンバーが備蓄品を消費する THEN システムは「[メンバー名]が[商品名]を[数量]消費しました」という通知を生成する SHALL
4. WHEN 期限切れ商品が発見される THEN システムは組織の全メンバーに通知を送信する SHALL
5. IF ユーザーが特定メンバーの活動のみを確認したい THEN システムはメンバー別のフィルター機能を提供する SHALL
6. WHEN 重要な変更が発生する THEN システムはプッシュ通知またはメール通知を送信する SHALL

### 要件 16

**ユーザーストーリー:** 備蓄管理者として、備蓄品の写真を撮影・管理したいので、視覚的に商品を識別し、状態を記録できるようになりたい

#### 受入基準

1. WHEN ユーザーが備蓄品を登録する THEN システムはカメラ機能で商品の写真撮影オプションを提供する SHALL
2. WHEN 写真が撮影される THEN システムは画像を圧縮してクラウドストレージに保存する SHALL
3. WHEN ユーザーが備蓄品一覧を表示する THEN システムは商品名と一緒にサムネイル画像を表示する SHALL
4. WHEN ユーザーが商品詳細を確認する THEN システムは登録された全ての写真をギャラリー形式で表示する SHALL
5. IF ユーザーが複数の写真を登録する THEN システムは最大5枚まで保存し、メイン画像を設定できる SHALL
6. WHEN 写真の状態が変化する THEN システムは新しい写真を追加して変化を記録する機能を提供する SHALL
7. WHEN ストレージ容量を管理する THEN システムは古い写真の自動削除設定を提供する SHALL
8. IF 写真のアップロードに失敗する THEN システムはローカルに保存し、次回同期時に再試行する SHALL

### 要件 17

**ユーザーストーリー:** 備蓄管理者として、期限の種類に応じた適切な管理をしたいので、食品の特性に合わせた期限管理ができるようになりたい

#### 受入基準

1. WHEN ユーザーが商品カテゴリを選択する THEN システムは食品カテゴリに対して期限タイプ（消費期限/賞味期限/両方）の選択を提供する SHALL
2. WHEN 商品に消費期限のみが設定される THEN システムは「この日まで安全に食べられます」というメッセージを表示する SHALL
3. WHEN 商品に賞味期限のみが設定される THEN システムは「この日まで美味しく食べられます」というメッセージを表示する SHALL
4. WHEN ユーザーが期限タイプ別にフィルタリングする THEN システムは消費期限商品、賞味期限商品、期限なし商品で絞り込み表示する SHALL
5. IF 商品が消費期限を過ぎている THEN システムは「危険」ラベルを表示し、消費を推奨しない警告を出す SHALL
6. IF 商品が賞味期限を過ぎているが消費期限内 THEN システムは「品質低下」ラベルを表示し、早めの消費を推奨する SHALL
7. WHEN 期限切れ統計を表示する THEN システムは消費期限切れと賞味期限切れを分けて集計する SHALL
8. WHEN バーコードスキャンで商品情報を取得する THEN システムは商品データベースから適切な期限タイプを自動判定する SHALL

### 要件 18

**ユーザーストーリー:** 備蓄管理者として、備蓄品を効率的に検索したいので、大量の備蓄品の中から目的の商品を素早く見つけることができるようになりたい

#### 受入基準

1. WHEN ユーザーが検索バーにキーワードを入力する THEN システムは商品名、ブランド名、説明文から部分一致検索を実行する SHALL
2. WHEN 検索結果が表示される THEN システムは関連度の高い順に結果をソートして表示する SHALL
3. WHEN ユーザーが複合検索を行う THEN システムはカテゴリ、保管場所、期限状態、タグを組み合わせたフィルター検索を提供する SHALL
4. WHEN ユーザーが高度な検索を使用する THEN システムは期限日範囲、価格範囲、数量範囲での絞り込み機能を提供する SHALL
5. IF 検索結果が0件の場合 THEN システムは「該当する商品が見つかりません」メッセージと検索条件の見直し提案を表示する SHALL
6. WHEN ユーザーが最近の検索履歴を確認する THEN システムは過去10件の検索キーワードを保存し、再検索オプションを提供する SHALL
7. WHEN 音声検索機能を使用する THEN システムは音声入力を文字に変換して検索を実行する SHALL
8. WHEN 検索候補を表示する THEN システムは入力中のキーワードに基づいて商品名の候補をリアルタイムで表示する SHALL
9. IF ユーザーがバーコードで検索する THEN システムはスキャンしたJANコードで該当商品を即座に検索する SHALL